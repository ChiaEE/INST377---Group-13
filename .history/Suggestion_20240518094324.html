<!DOCTYPE html>
<html>
<head>
    <title>Suggestion</title>
    <link rel="stylesheet" href="HomePage.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body style="background-color: #226ca1;">
    <!-- Header Section -->
    <header id="bar">
        <h1>Have a suggestion?</h1>
    </header>

    <!-- Navigation Menu -->
    <nav id="main-nav">
        <ul id="navList">
            <li><a href="index.html">HOME</a></li>
            <li><a href="About_page.html">ABOUT</a></li>
            <li id="childrensBooksLink"><a href="Children'sBooks.html">Children's Books</a></li>
            <li id="fictionBooksLink"><a href="FictionBooks.html">Fiction Books</a></li>
            <li id="nonFictionBooks"><a href="NonFictionBooks.html"> Non-Fiction Books </a></li>
            <li id="comedyBooksLink"><a href="ComedyBooks.html">Comedy Books</a></li>
            <li id="romanceBooksLink"><a href="RomanceBooks.html">Romance Books</a></li>
            <li id="dramaBooksLink"><a href="DramaBooks.html">Drama Books</a></li>
            <li id="sciBooksLink"><a href="ScienceBooks.html">Science Books</a></li>
            <li id="horrorBooksLink"><a href="HorrorBooks.html">Horror Books</a></li>
            <li id="mysteryBooksLink"><a href="MysteryBooks.html">Mystery Books</a></li>
            <li id="SuggestionsLink"><a href="Suggestion.html">Suggestion?</a></li>
        </ul>
    </nav>

    <!-- Suggestions -->
    <form id="user-form">
        <h2>Have a suggestion?</h2>
        <h3>Please fill out at least one!</h3>
        <label for="title">Title Name:</label>
        <input type="text" name="title" id="title" required>
        <br>
        <label for="author">Author Name:</label>
        <input type="text" id="author" name="author" required>
        <br>
        <button type="submit">Submit</button>
    </form>
    
    <div id="confirmation" style="display: none;">Data submitted successfully! Thank you!</div>
    <div id="error" style="display: none;">An error occurred. Please try again.</div>

    <script>
    document.addEventListener("DOMContentLoaded", function() {
        // Supabase configuration
        const SUPABASE_URL = 'https://dkrtmelljyeyesrteyhf.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRrcnRtZWxsanlleWVzcnRleWhmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTU1MzUxNTUsImV4cCI6MjAzMTExMTE1NX0.xLDZ3H1Y0sGUC8tVAccJqm5YK2hwtZyWMB_AZD5vb74';
        const supabase = supabase.createClient({ url: SUPABASE_URL, anonKey: SUPABASE_ANON_KEY });

        // Handle form submission
        document.getElementById('user-form').addEventListener('submit', async function(event) {
            event.preventDefault();

            // Collect form data
            const title = document.getElementById('title').value.trim();
            const author = document.getElementById('author').value.trim();
            
            // Validate that all fields are filled out
            if (!title || !author) {
                alert('Please fill out all fields.');
                return;
            }

            // Insert data into Supabase table
            try {
                const { data, error } = await supabase
                    .from('book_suggestions')
                    .insert([{ book_name: title, book_author: author }]);

                if (error) {
                    throw error;
                }

                console.log('Data inserted successfully:', data);
                document.getElementById('confirmation').style.display = 'block';
                document.getElementById('error').style.display = 'none';
                document.getElementById('user-form').reset();
                setTimeout(() => {
                    document.getElementById('confirmation').style.display = 'none';
                }, 3000); // Hide confirmation after 3 seconds
            } catch (error) {
                console.error('Error inserting data:', error);
                document.getElementById('error').style.display = 'block';
                document.getElementById('confirmation').style.display = 'none';
            }
        });
    });
    </script>
</body>
</html>